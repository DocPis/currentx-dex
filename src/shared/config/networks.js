// src/shared/config/networks.js
// Centralized network preset (mainnet only).

const env = typeof import.meta !== "undefined" ? import.meta.env || {} : {};
const DEFAULT_MAINNET_SUBGRAPH_URL =
  env.VITE_UNIV2_SUBGRAPH ||
  "https://gateway.thegraph.com/api/subgraphs/id/3berhRZGzFfAhEB5HZGHEsMAfQ2AQpDk2WyVr5Nnkjyv";
const DEFAULT_MAINNET_SUBGRAPH_API_KEY = env.VITE_UNIV2_SUBGRAPH_API_KEY || "";
const DEFAULT_MAINNET_V3_SUBGRAPH_URL =
  env.VITE_UNIV3_SUBGRAPH ||
  "https://api.goldsky.com/api/public/project_cmlbj5xkhtfha01z0caladt37/subgraphs/currentx-v3/1.0.0/gn";
const DEFAULT_MAINNET_V3_SUBGRAPH_API_KEY = env.VITE_UNIV3_SUBGRAPH_API_KEY || "";
const DEFAULT_CHAINLINK_ETH_USD_FEED = env.VITE_CHAINLINK_ETH_USD_FEED || "";
const DEFAULT_CHAINLINK_RPC_URL = env.VITE_CHAINLINK_RPC_URL || "";
const DEFAULT_CURRENTX_ADDRESS =
  env.VITE_CURRENTX_ADDRESS || "0xC9590D27b37F0Ac1B5BcF10F5e4bD4cfced49269";
const DEFAULT_CURRENTX_VAULT_ADDRESS =
  env.VITE_CURRENTX_VAULT_ADDRESS || "0x61186F1a227c1225a3660628C728D6943c836FEb";
const DEFAULT_LP_LOCKER_V2_ADDRESS =
  env.VITE_LP_LOCKER_V2_ADDRESS || "0xc43B8a818c9dAd3C3F04230c4033131Fe040408f";

const dedupeList = (arr = []) => {
  const seen = new Set();
  const out = [];
  arr.forEach((entry) => {
    const parts = (entry || "")
      .split(",")
      .map((v) => v.trim())
      .filter(Boolean);
    parts.forEach((p) => {
      if (seen.has(p)) return;
      seen.add(p);
      out.push(p);
    });
  });
  return out;
};

const mainnetPreset = {
  id: "mainnet",
  label: "Mainnet",
  name: "MegaETH",
  chainIdHex: "0x10e6", // 4326
  chainlinkRpcUrl: DEFAULT_CHAINLINK_RPC_URL,
  explorer:
    env.VITE_EXPLORER_BASE ||
    env.VITE_MEGAETH_EXPLORER ||
    "https://megaeth.blockscout.com",
  subgraphUrl: DEFAULT_MAINNET_SUBGRAPH_URL,
  subgraphApiKey: DEFAULT_MAINNET_SUBGRAPH_API_KEY,
  v3SubgraphUrl: DEFAULT_MAINNET_V3_SUBGRAPH_URL,
  v3SubgraphApiKey: DEFAULT_MAINNET_V3_SUBGRAPH_API_KEY,
  rpcUrls: dedupeList([
    env.VITE_RPC_URL,
    env.VITE_RPC_URLS,
    env.VITE_MEGAETH_RPC,
    env.VITE_RPC_FALLBACK,
    env.VITE_RPC_TATUM,
    env.VITE_RPC_THIRDWEB,
    "https://mainnet.megaeth.com/rpc",
    "https://rpc-megaeth-mainnet.globalstake.io",
  ]),
  wsUrls: dedupeList([
    env.VITE_WS_URL,
    env.VITE_WS_URLS,
    env.VITE_MEGAETH_REALTIME_WS,
  ]),
  addresses: {
    WETH_ADDRESS: "0x4200000000000000000000000000000000000006",
    USDC_ADDRESS: "",
    USDT0_ADDRESS: "0xB8CE59FC3717ada4C02eaDF9682A9e934F625ebb",
    CUSD_ADDRESS: "0xcCcc62962d17b8914c62D74FfB843d73B2a3cccC",
    STCUSD_ADDRESS: "0x88887bE419578051FF9F4eb6C858A951921D8888",
    SUSDE_ADDRESS: "0x211Cc4DD073734dA055fbF44a2b4667d5E5fE5d2",
    USDE_ADDRESS: "0x5d3a1Ff2b6BAb83b63cd9AD0787074081a52ef34",
    EZETH_ADDRESS: "0x09601A65e7de7BC8A19813D263dD9E98bFdC3c57",
    WSTETH_ADDRESS: "0x601aC63637933D88285A025C685AC4e9a92a98dA",
    USDM_ADDRESS: "0xFAfDdbb3FC7688494971a79cc65DCa3EF82079E7",
    CRX_ADDRESS: "0xBd5e387fa453ceBf03B1A6a9dFe2a828b93AA95B",
    MEGA_TOKEN_ADDRESS: "0x28B7E77f82B25B95953825F1E3eA0E36c1c29861",
    XBTC_ADDRESS: "",
    BTCB_ADDRESS: "0xB0F70C0bD6FD87dbEb7C10dC692a2a6106817072",
    WUSD_ADDRESS: "",
    WUSDC_ADDRESS: "",
    MASTER_CHEF_ADDRESS: "0x0e59533B28df0537bc28D05618a2c4f20EBE07a0",
    CRX_WETH_LP_ADDRESS: "0x340d63169285e5ae01a722ce762c0e81a7fa3037",
    HIGH_PRECISION_TIMESTAMP_ORACLE_ADDRESS:
      "0x6342000000000000000000000000000000000002",
    UNIV2_FACTORY_ADDRESS: "0xC60940F182F7699522970517f6d753A560546937",
    UNIV2_ROUTER_ADDRESS: "0x189b27c207b4cBBae1C65086F31383532443f5f2",
    UNIV2_PAIR_CODE_HASH:
      "0x552cb211a6cb6b2c7b263255f787f454e28411eb3ffb49389d5b6e73cd2966d0",
    UNIV3_FACTORY_ADDRESS: "0x09cF8A0b9e8C89bff6d1ACbe1467e8E335Bdd03E",
    UNIV3_QUOTER_V2_ADDRESS: "0x962e62df3df243844bd89ffb5b061919725dca2d",
    UNIV3_TICK_LENS_ADDRESS: "0xd8fe4a55f7f79d2937637671923e59d8488683c3",
    UNIV3_SWAP_ROUTER_ADDRESS: "0x5a8bc70674d82ac2bc04be91cf172f60169c50b3",
    UNIV3_POSITION_MANAGER_ADDRESS: "0xa02e90a5f5ef73c434f5a7e6a77e6508f009cb9d",
    UNIV3_MULTICALL_ADDRESS: "0x47163ef055ac5efdfdd946303f86820736bfbb8d",
    UNIV3_MIGRATOR_ADDRESS: "0xAA5B9F20e788063CD1e7e482c9F55b8c803E5456",
    UNIV3_POOL_INIT_CODE_HASH:
      "0xc5b9323f38f7ec5daae18bf2b6696c143def3728c6f6ed2aa34dcb31ad4fbf3f",
    UNIV3_UNIVERSAL_ROUTER_ADDRESS: "0x2c61d16Ad68f030bec95370Ab8a0Ba60e7E7B0a6",
    PERMIT2_ADDRESS: "0x000000000022D473030F116dDEE9F6B43aC78BA3",
    V3_STAKER_ADDRESS: "0xc6a9dB70b5618DfbCA05Fa7db11bEC48782D5590",
    CHAINLINK_ETH_USD_FEED: DEFAULT_CHAINLINK_ETH_USD_FEED,
    CURRENTX_ADDRESS: DEFAULT_CURRENTX_ADDRESS,
    CURRENTX_VAULT_ADDRESS: DEFAULT_CURRENTX_VAULT_ADDRESS,
    LP_LOCKER_V2_ADDRESS: DEFAULT_LP_LOCKER_V2_ADDRESS,
  },
};

export const getActiveNetworkConfig = () => mainnetPreset;
